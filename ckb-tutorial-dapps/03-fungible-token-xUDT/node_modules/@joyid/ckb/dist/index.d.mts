import { SignMessageResponseData, CredentialKeyType, SigningAlg, Script, CellDep, CkbDappConfig, PopupConfigOptions, AuthResponseData, CkbTransactionRequest, CKBTransaction, CotaNFTTransactionRequest, SignCkbTxResponseData } from '@joyid/common';
export { AuthRequest, AuthResponse, CKBTransaction, CkbDappConfig, AuthResponseData as ConnectResponseData, CotaNFTTransactionRequest, CredentialKeyType, PopupConfigOptions as PopupConifg, SignMessageResponseData as SignChallengeResponseData, SignCkbTxRequest, SignCotaNFTRequest, SignMessageRequest, SignMessageResponse, SigningAlg, openPopup } from '@joyid/common';

declare const ensureChallenge: (challenge: string, clientData: ArrayBuffer) => boolean;
declare const verifySessionKeySignature: (message: string, signature: string, pubkey: string) => Promise<boolean>;
declare const verifyNativeKeySignature: ({ message, signature, pubkey, challenge, alg, }: SignMessageResponseData) => Promise<boolean>;
declare const verifySignature: (data: SignMessageResponseData) => Promise<boolean>;
interface CredentialInfo {
    pubkey: string;
    address: string;
    keyType: CredentialKeyType;
    alg: SigningAlg;
}
/**
 * Verifies the credential information.
 *
 * @param {CredentialInfo} credential Information of the credential to verify.
 * @param {string} joyidServerURL The URL of the JOYID server. <br>
 * Testnet: https://api.testnet.joyid.dev/api/v1 <br>
 * Mainnet: https://api.joy.id/api/v1
 * @returns {Promise<boolean>} A promise that resolves to a boolean indicating
 *                              whether the verification was successful.
 */
declare function verifyCredential(credential: CredentialInfo, joyidServerURL: string): Promise<boolean>;
/**
 * Verifies the credential information.
 *
 * @param {string} pubkey The public key of the credential to verify.
 * @param {string} address The address of the credential to verify.
 * @param {CredentialKeyType} keyType Type of the key.
 * @param {SigningAlg} alg The signing algorithm to be used.
 * @returns {Promise<boolean>} A promise that resolves to a boolean indicating
 *                              whether the verification was successful.
 */
declare function verifyCredential(pubkey: string, address: string, keyType: CredentialKeyType, alg: SigningAlg): Promise<boolean>;

declare const getJoyIDLockScript: (isMainnet: boolean) => Script;
declare const getJoyIDCellDep: (isMainnet: boolean) => CellDep;
declare const getCotaTypeScript: (isMainnet: boolean) => Script;
declare const getCotaCellDep: (isMainnet: boolean) => CellDep;

type Hex = string;
type Byte2 = string | number;
type Bytes = string;
interface BaseReq {
}
interface BaseResp {
}
interface SubkeyUnlockReq extends BaseReq {
    lock_script: Bytes;
    pubkey_hash: Hex;
    alg_index: Byte2;
}
interface SubkeyUnlockResp extends BaseResp {
    unlock_entry: Bytes;
    block_number: bigint;
}

declare class Aggregator {
    private readonly url;
    constructor(url: string);
    private baseRPC;
    generateSubkeyUnlockSmt(req: SubkeyUnlockReq): Promise<SubkeyUnlockResp>;
}

declare const initConfig: (config?: CkbDappConfig) => CkbDappConfig;
declare const getConfig: () => CkbDappConfig;
type SignConfig = CkbDappConfig & Pick<PopupConfigOptions, 'timeoutInSeconds' | 'popup'> & {
    witnessIndexes?: number[];
};
declare const connect: (config?: SignConfig) => Promise<AuthResponseData>;
declare const signChallenge: (challenge: string | Uint8Array, signerAddress: string, config?: SignConfig) => Promise<SignMessageResponseData>;
declare const signTransaction: (tx: CkbTransactionRequest, config?: SignConfig) => Promise<CKBTransaction>;
declare const signCotaNFTTx: (tx: CotaNFTTransactionRequest, config?: SignConfig) => Promise<CKBTransaction>;
declare const signRawTransaction: (tx: CKBTransaction, signerAddress: string, config?: SignConfig) => Promise<SignCkbTxResponseData['tx']>;
declare const calculateChallenge: (tx: CKBTransaction, witnessIndexes?: number[]) => Promise<string>;
declare const buildSignedTx: (unsignedTx: CKBTransaction, signedData: SignMessageResponseData, witnessIndexes?: number[]) => CKBTransaction;
declare const getSubkeyUnlock: (aggregatorUrl: string, connection: AuthResponseData) => Promise<string>;

export { Aggregator, SignConfig, buildSignedTx, calculateChallenge, connect, ensureChallenge, getConfig, getCotaCellDep, getCotaTypeScript, getJoyIDCellDep, getJoyIDLockScript, getSubkeyUnlock, initConfig, signChallenge, signCotaNFTTx, signRawTransaction, signTransaction, verifyCredential, verifyNativeKeySignature, verifySessionKeySignature, verifySignature };
